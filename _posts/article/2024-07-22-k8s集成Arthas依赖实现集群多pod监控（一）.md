---

layout: post

title: "2024-07-22-k8sé›†æˆArthasä¾èµ–å®ç°é›†ç¾¤å¤špodç›‘æ§(ä¸€)"

date:   2024-07-22

tags: [thinking,å¿ƒç†å­¦,æœ‰æ•ˆåŠªåŠ›,basic knowledge]

comments: true

author: é˜¿æ˜±

---


## èƒŒæ™¯ä»‹ç»
---
	å¼€å§‹ä¹‹å‰å…ˆç®€å•è®°å½•ä¸€ä¸‹è‡ªå·±åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­äº†è§£å’Œå­¦ä¹ åˆ°çš„çŸ¥è¯†ï¼Œå½“æˆ‘ä»¬ä¸€è…”çƒ­è¡€å¼€å§‹å°è¯•ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸€å®šä¸èƒ½é™·å…¥è¿›å»ï¼Œåº”è¯¥æ—¶åˆ»æé†’è‡ªå·±ï¼Œä¸è¦åªé¡¾çœ¼å‰çš„ä»»åŠ¡å’Œæ€¥äºæ±‚æˆï¼Œè€Œæ˜¯åº”è¯¥æ€€ç€ä½“éªŒæŠ€æœ¯ï¼Œæ¥è§¦æ–°æ€æƒ³å’Œäº‹ç‰©çš„å¿ƒæ€å»ä¸“æ³¨å®Œæˆï¼Œå®Œæˆåæˆ–åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­è®°å½•ä¸‹è‡ªå·±å­¦çš„ä¸œè¥¿ï¼Œæ‰èƒ½å®Œæˆä¸€æ¬¡å®Œç¾å­¦ä¹ çš„é—­ç¯ï¼Œçªç ´è‡ªå·±ï¼Œè·å–æ›´å¥½çš„æŠ€æœ¯æå‡ã€‚
### Arthas
Arthas æ˜¯ä¸€ä¸ªå¼€æºçš„ Java è¯Šæ–­å·¥å…·ï¼Œç”±é˜¿é‡Œå·´å·´å¼€æºã€‚å®ƒä¸»è¦ç”¨äºåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¯¹ Java åº”ç”¨è¿›è¡Œç›‘æ§ã€è¯Šæ–­ã€‚Arthas å…è®¸å¼€å‘è€…åœ¨ä¸åœæ­¢åº”ç”¨çš„æƒ…å†µä¸‹ï¼ŒåŠ¨æ€åœ°æŸ¥çœ‹åº”ç”¨çš„è¿è¡ŒçŠ¶æ€ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š
- **JVM å®æ—¶ç›‘æ§**ï¼šæŸ¥çœ‹ JVM çš„å®æ—¶çŠ¶æ€ï¼ŒåŒ…æ‹¬çº¿ç¨‹å †æ ˆã€å†…å­˜ä½¿ç”¨ã€GC çŠ¶æ€ç­‰ã€‚
- **Class å’Œ Method è¯Šæ–­**ï¼šå¯ä»¥æŸ¥çœ‹å’Œç›‘æ§ Java ç±»çš„åŠ è½½ä¿¡æ¯ï¼Œæ–¹æ³•çš„è°ƒç”¨ç»Ÿè®¡ï¼Œç”šè‡³å¯ä»¥åœ¨è¿è¡Œæ—¶ä¿®æ”¹ç±»çš„å®šä¹‰ã€‚
- **SQL è¯Šæ–­**ï¼šå¯¹æ•°æ®åº“æ“ä½œè¿›è¡Œç›‘æ§ï¼ŒæŸ¥çœ‹ SQL æ‰§è¡Œæ—¶é—´ï¼Œå¸®åŠ©å®šä½æ€§èƒ½ç“¶é¢ˆã€‚
- **ç³»ç»ŸæŒ‡æ ‡ç›‘æ§**ï¼šæŸ¥çœ‹ç³»ç»Ÿçš„å„ç§æŒ‡æ ‡ï¼Œå¦‚ CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œç­‰ã€‚
- **å‘½ä»¤è¡Œäº¤äº’**ï¼šæä¾›äº†ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œé€šè¿‡å„ç§å‘½ä»¤æ¥å®ç°å¯¹åº”ç”¨çš„è¯Šæ–­ã€‚
### Arthas Spring Boot Starter
Arthas Spring Boot Starter æ˜¯ä¸€ä¸ªä¸º Spring Boot åº”ç”¨é›†æˆé˜¿é‡Œå·´å·´å¼€æº Java è¯Šæ–­å·¥å…· Arthas çš„å¯åŠ¨å™¨ï¼Œå½“springbooté›†æˆäº†Starteråï¼Œæ— éœ€é‡å¯åº”ç”¨ï¼Œå³å¯åŠ¨æ€åœ°è¿æ¥åˆ°åº”ç”¨è¿›ç¨‹ï¼Œæ‰§è¡Œå„ç§è¯Šæ–­å‘½ä»¤ã€‚Arthas agentä¼šè·Ÿéšé¡¹ç›®ä¸€èµ·å¯åŠ¨ï¼Œåº”ç”¨å¯åŠ¨åï¼Œspring ä¼šå¯åŠ¨ arthasï¼Œå¹¶ä¸” attach è‡ªèº«è¿›ç¨‹ã€‚é›†æˆåspringbootæœåŠ¡å¯ä»¥é€šè¿‡é…ç½® tunnel server å®ç°è¿œç¨‹ç®¡ç†ã€‚

### # Arthas Tunnel
Arthas Tunnel çš„å·¥ä½œåŸç†æ˜¯åœ¨ç›®æ ‡ Java åº”ç”¨ä¸Šå¯åŠ¨ä¸€ä¸ª Arthas Agentï¼Œè¿™ä¸ª Agent ä¼šåˆ›å»ºä¸€ä¸ªåˆ° Arthas Tunnel Server çš„è¿æ¥ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡è®¿é—® Arthas Tunnel Server æä¾›çš„ Web æ§åˆ¶å°ï¼Œæ¥è¿œç¨‹æ‰§è¡Œ Arthas æ”¯æŒçš„å„ç§è¯Šæ–­å‘½ä»¤ï¼Œå°±åƒç›´æ¥åœ¨ç›®æ ‡æœºå™¨ä¸Šæ“ä½œä¸€æ ·ã€‚Arthas Tunnel ä¸è¢«ç›‘å¬å¯¹è±¡ï¼ˆå³ç›®æ ‡ Java åº”ç”¨ï¼‰å»ºç«‹çš„è¿æ¥æ˜¯ä¸€ä¸ªåŸºäº WebSocket æˆ– HTTP çš„é•¿è¿æ¥ã€‚è¿™ç§è¿æ¥å…è®¸åŒå‘é€šä¿¡ï¼Œå³ Arthas Tunnel Server å¯ä»¥æ¥æ”¶æ¥è‡ªè¢«ç›‘å¬å¯¹è±¡çš„æ•°æ®ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å‘é€å‘½ä»¤åˆ°è¢«ç›‘å¬å¯¹è±¡ã€‚

### Kubernetes
Kubernetesï¼ˆé€šå¸¸ç®€ç§°ä¸º k8sï¼‰æ˜¯ä¸€ä¸ªå¼€æºå¹³å°ï¼Œç”¨äºè‡ªåŠ¨éƒ¨ç½²ã€æ‰©å±•å’Œç®¡ç†å®¹å™¨åŒ–åº”ç”¨ç¨‹åºã€‚åœ¨ Kubernetes ä¸­ï¼ŒPod æ˜¯æœ€å°çš„éƒ¨ç½²å•å…ƒï¼Œå¯ä»¥è¢«åˆ›å»ºå’Œç®¡ç†ã€‚

ä¸€ä¸ª Pod é€šå¸¸åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ï¼ˆä¾‹å¦‚ Docker å®¹å™¨ï¼‰ã€‚å¦‚æœä¸€ä¸ª Pod åŒ…å«å¤šä¸ªå®¹å™¨ï¼Œè¿™äº›å®¹å™¨ä¼šè¢«éƒ¨ç½²åœ¨åŒä¸€ä¸ªå®¿ä¸»æœºä¸Šï¼Œå¹¶ä¸”å¯ä»¥å…±äº«èµ„æºã€‚æ¯ä¸ª Pod éƒ½æœ‰ä¸€ä¸ªç‹¬ç‰¹çš„ IP åœ°å€ï¼Œå…è®¸å®¹å™¨ä½¿ç”¨ç½‘ç»œè¿›è¡Œé€šä¿¡ã€‚

Pod çš„å…³é”®ç‰¹æ€§åŒ…æ‹¬ï¼š
- **å…±äº«ç½‘ç»œ**ï¼šPod å†…çš„æ‰€æœ‰å®¹å™¨å…±äº«ä¸€ä¸ª IP åœ°å€å’Œç«¯å£ç©ºé—´ï¼Œå®ƒä»¬å¯ä»¥é€šè¿‡ localhost ç›¸äº’é€šä¿¡ã€‚
- **å…±äº«å­˜å‚¨**ï¼šPod å¯ä»¥å®šä¹‰å…±äº«å­˜å‚¨å·ï¼Œè¿™äº›å­˜å‚¨å·å¯ä»¥è¢« Pod å†…çš„æ‰€æœ‰å®¹å™¨è®¿é—®ã€‚
- **ç”Ÿå‘½å‘¨æœŸ**ï¼šé€šå¸¸ï¼ŒPod ä¸­çš„å®¹å™¨ä¼šä¸€èµ·å¯åŠ¨ã€ä¸€èµ·åœæ­¢ã€‚Pod ä½œä¸ºä¸€ä¸ªæ•´ä½“è¢«è°ƒåº¦åˆ°èŠ‚ç‚¹ä¸Šï¼Œå®ƒä»¬å…±äº«ç›¸åŒçš„ç”Ÿå‘½å‘¨æœŸã€è°ƒåº¦ä¸Šä¸‹æ–‡å’Œç³»ç»Ÿèµ„æºã€‚
- **è‡ªæˆ‘æ²»æ„ˆ**ï¼šKubernetes ä¼šè‡ªåŠ¨æ›¿æ¢å‘ç”Ÿæ•…éšœçš„ Podï¼Œç¡®ä¿æ‰€éƒ¨ç½²çš„åº”ç”¨æ•°é‡ç¬¦åˆç”¨æˆ·çš„æœŸæœ›çŠ¶æ€ã€‚

Pods æ˜¯ Kubernetes åº”ç”¨çš„åŸºçŸ³ï¼Œå®ƒä»¬ä½¿å¾—å®¹å™¨åŒ–åº”ç”¨çš„éƒ¨ç½²å’Œç®¡ç†å˜å¾—æ›´åŠ çµæ´»å’Œé«˜æ•ˆã€‚
è®¾è®¡Podé—´é€šä¿¡æ—¶ï¼Œæ¨èä½¿ç”¨Serviceï¼Œ- Kubernetes çš„ Service æ˜¯ä¸€ç§æŠ½è±¡ï¼Œå®ƒå®šä¹‰äº†ä¸€ç§è®¿é—® Pod çš„æ–¹å¼ï¼Œæ— è®ºèƒŒåæœ‰å¤šå°‘ Pod å®ä¾‹ã€‚Service ä¸ºä¸€ç»„å…·æœ‰ç›¸åŒåŠŸèƒ½çš„ Pod æä¾›ä¸€ä¸ªå•ä¸€çš„å…¥å£åœ°å€ï¼ˆIP åœ°å€å’Œç«¯å£å·ï¼‰ï¼Œå…¶ä»– Pod å¯ä»¥é€šè¿‡è¿™ä¸ªåœ°å€è®¿é—®åç«¯çš„ä¸€ç»„ Podã€‚Kubernetes (k8s) é›†ç¾¤ä¸­çš„ Pods äº’ç›¸é€šä¿¡å’Œè®¿é—®ã€‚

## éƒ¨ç½²å‡†å¤‡
---
**ä¸ªäººå®è·µç»éªŒï¼š**
- k8sé›†ç¾¤ï¼šé˜¿é‡Œäº‘å®¹å™¨æœåŠ¡ Kubernetes ç‰ˆï¼ˆACKï¼‰
- ç›®æ ‡æœåŠ¡jdkç‰ˆæœ¬ï¼š 1.8 æˆ–è€…jdk 21
- springbootç‰ˆæœ¬ï¼š springboot 2.x æˆ–è€…springboot3.x
- Arthasæºç (ä¸»è¦ç”¨äºå®šåˆ¶arthas-tunnel-server 2024-07-18 v3.7.2)ï¼šhttps://github.com/alibaba/arthas.git
- arthas-spring-boot-starter v3.7.2ï¼š [Maven Central Repository Search](https://search.maven.org/search?q=arthas-spring-boot-starter)
- é˜¿é‡Œäº‘dockeré•œåƒä»“åº“(ç§æœä»“åº“ï¼Œç”¨äºæœ¬åœ°æ‰“åŒ…é•œåƒéƒ¨ç½²åˆ°é›†ç¾¤)
- æ³¨æ„âš ï¸âš ï¸ï¼šjavaæœåŠ¡ä¸€å®šè¦ä½¿ç”¨jdkç¯å¢ƒï¼Œå•çº¯jreç¯å¢ƒæ— æ³•ä½¿ç”¨arthasï¼Œä¾‹å¦‚Arthas æœ‰æ—¶éœ€è¦ç¼–è¯‘ç”¨æˆ·è¾“å…¥çš„ Java ä»£ç ç‰‡æ®µè¿™æ—¶å°±éœ€è¦é€šè¿‡ç¼–è¯‘å™¨å·¥å…·javacæ‰èƒ½å®ç°ï¼›Arthas éœ€è¦ä½¿ç”¨åˆ° JDK ä¸­æä¾›çš„é«˜çº§ç±»åŠ è½½æœºåˆ¶ï¼Œä»¥ä¾¿å®ƒèƒ½å¤Ÿåœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½ã€æ›´æ–°å’Œå¸è½½ç±»ã€‚æ‰€ä»¥ä¸€å®šè¦æ£€æŸ¥éƒ¨ç½²çš„javaæœåŠ¡ä½¿ç”¨çš„é•œåƒæ˜¯å¦ç”¨jdkï¼Œå®˜æ–¹å»ºè®®ä½¿ç”¨`openjdk:8-jdk`æˆ–è€…`openjdk:8-jdk-alpine`ã€‚
## å®è·µç¯èŠ‚
---
### ç›®æ ‡springbootåº”ç”¨é›†æˆStarterï¼Œé…ç½®ä¿¡é“
- å¼•å…¥starterä¾èµ–
```xml
<dependency>  
    <groupId>com.taobao.arthas</groupId>  
    <artifactId>arthas-spring-boot-starter</artifactId>  
    <version>3.7.2</version>  
</dependency>

```
- é…ç½®é¡¹æ·»åŠ serverä¿¡é“ï¼Œè¯¦ç»†é…ç½®å¯å‚è€ƒå®˜ç½‘æ–‡æ¡£[Arthas Properties | arthas (aliyun.com)](https://arthas.aliyun.com/doc/arthas-properties.html)
```properties
arthas.appName=demoapp
arthas.tunnelServer=ws://127.0.0.1:7777/ws
arthas.agentId=mmmmmmyiddddd
```
æ·»åŠ å¥½åå¯åŠ¨é¡¹ç›®ï¼Œå¦‚æœé…ç½®æ­£å¸¸å¯ä»¥åœ¨æ§åˆ¶å°çœ‹åˆ°Arthasè‡ªåŠ¨è£…é…é…ç½®çš„æ—¥å¿—è¾“å‡ºï¼š
![https://s2.loli.net/2024/07/18/o9Ck7bFARNJmP2X.png](https://s2.loli.net/2024/07/18/o9Ck7bFARNJmP2X.png)

å¦‚æœæ˜¯springboot3 ç›®å‰çš„3.7.2ä¹Ÿæ˜¯æ”¯æŒçš„ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯éœ€è¦è‡ªå·±æŒ‰ç…§springboot3çš„ç‰¹æ€§å°†é…ç½®æ–‡ä»¶importå‚è€ƒï¼š[Arthas Spring Boot Starter æœ‰è®¡åˆ’æ”¯æŒ SpringBoot3 å—ï¼Ÿ Â· Issue #2599 Â· alibaba/arthas (github.com)](https://github.com/alibaba/arthas/issues/2599)
[arthas-spring-boot-starter éœ€è¦æ”¯æŒ spring boot3 Â· Issue #2524 Â· alibaba/arthas (github.com)](https://github.com/alibaba/arthas/issues/2524)
éœ€è¦åœ¨META-INF.springï¼ˆåç§°å¦‚æ­¤ï¼‰æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºå¦‚ä¸‹æ–‡ä»¶ï¼šorg.springframework.boot.autoconfigure.AutoConfiguration.imports
æ·»åŠ é…ç½®é¡¹ï¼š
```java
# ä»¥ä¸‹æ˜¯Arthasçš„è‡ªåŠ¨è£…é…é…ç½®æ–‡ä»¶ 4.0å‘å¸ƒåä¸å†éœ€è¦  
com.alibaba.arthas.spring.ArthasConfiguration  
com.alibaba.arthas.spring.endpoints.ArthasEndPointAutoConfiguration
```

### æ‰“åŒ…éƒ¨ç½²Tune Server 
- é¦–å…ˆå…ˆæ‹‰ä¸€ä¸‹å®˜æ–¹çš„æºç ï¼Œç”¨äºæœ¬åœ°æ‰“åŒ…
```shell
https://github.com/alibaba/arthas.git
```
æ‹‰ä¸‹æ¥åï¼Œä¸è¦æ€¥ç€æ‰“åŒ…ï¼Œå®˜æ–¹æä¾›äº†ä¸åŒç¯å¢ƒçš„æ‰“åŒ…é…ç½®ï¼Œé»˜è®¤åº”è¯¥æ˜¯ä¼šè‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿè¿›è¡ŒåŒ¹é…ï¼Œç¡®å®ç‰›çš„ï¼Œéå¸¸æ–¹ä¾¿ã€‚ç”±äºæˆ‘çš„æ˜¯macOSï¼Œéœ€è¦ä¿®æ”¹ä¸€ä¸‹é…ç½®mavenæ‰“åŒ…æ—¶æ‰èƒ½æ­£å¸¸æ£€æµ‹åˆ°javaçš„pathå¦‚æœä½ æ‰“åŒ…çš„ç¯å¢ƒä¹Ÿæ˜¯çš„è¯ï¼Œéœ€è¦è®°å¾—ä¿®æ”¹ä¸€ä¸‹arthas-vmtoolçš„pom.xml
å°†pom.xmlä¸­çš„`${JAVA_HOME}`æ›¿æ¢ä¸º `${env.JAVA_HOME}`ã€‚
![image.png](https://s2.loli.net/2024/07/18/2PCsyQoYGKM3ca6.png)

- å®šåˆ¶ä¸€ä¸‹serverçš„é…ç½®æˆ–åŠŸèƒ½ï¼Œæˆ‘ä¸»è¦å°†ç«¯å£å·å’Œå¯†ç æ”¹äº†ï¼Œserverä½¿ç”¨çš„æ˜¯Spring Scurityï¼Œä¿®æ”¹å¯†ç åªç”¨æ”¹é…ç½®æ–‡ä»¶å°±å¯ä»¥äº†ã€‚
- æ‰§è¡Œmavenå‘½ä»¤è¿›è¡Œæ‰“åŒ…,è¿™æ˜¯æˆ‘çš„æ‰“åŒ…å‘½ä»¤ï¼š
```shell
mvn clean package -Dmaven.test.skip=true
```
- ç¼–å†™æ„å»ºé•œåƒçš„Dockerfileï¼Œå’Œtunnel-serverçš„pom.xmlæ”¾ä¸€èµ·ã€‚è¿™é‡Œæˆ‘ä½¿ç”¨çš„åŸºç¡€é•œåƒæ˜¯å…¬å¸çš„ç§æœé•œåƒ
```shell
FROM registry.cn-beijing.aliyuncs.com/devops-op/openjdk:1.8.0_212  
MAINTAINER bixiaoyu@bjca.org.cn  
  
#ENV TZ=Asia/Shanghai  
RUN mkdir /data/webserver -p  
  
ENV LANG en_US.UTF-8  
ADD start.sh /data/webserver/  
RUN chmod +x /data/webserver/start.sh  
  
#COPY agent /data/agent  
ADD ./target/arthas-tunnel-server-4.0.0-SNAPSHOT-sources.jar   /data/webserver/  
#RUN apk add --update ttf-dejavu fontconfig  
  
EXPOSE 7777  
EXPOSE 9342  
  
ENTRYPOINT ["/data/webserver/start.sh"]
```
- æ„å»ºé•œåƒå¹¶ä¸”ä¸Šä¼ åˆ°å…¬å¸ç§æœï¼Œåç»­æ–¹ä¾¿éƒ¨ç½²åˆ°é˜¿é‡Œäº‘k8s
```shell
#1 æ„å»ºä¸šåŠ¡é•œåƒ
sudo docker build -t maidsg/arthas-tunnel-server:1.0 .Â 

#2 è°ƒæ•´é•œåƒåï¼ŒåŒ¹é…ç§æœ
docker tag maidsg/arthas-tunnel-server:1.0Â  [registry.cn-beijing.aliyuncs.com/devops-op/arthas-tunnel-server:1.0](http://registry.cn-beijing.aliyuncs.com/devops-op/arthas-tunnel-server:1.0)

#3 ä¸Šä¼ ç§æœ
Â docker push registry.cn-beijing.aliyuncs.com/devops-op/arthas-tunnel-server:1.0
```
å…¶å®é•œåƒæ„å»ºå¥½åå°±å¯ä»¥å…ˆåœ¨æœ¬åœ°ç”¨dockerè·‘ä¸€ä¸‹çœ‹çœ‹æ•ˆæœäº†ï¼Œä¹Ÿå¯ä»¥è¿ä¸Šç›®æ ‡æœåŠ¡å†™ä¸€ä¸ªdocker-composeå…ˆåœ¨æœ¬åœ°éªŒè¯ä¸€ä¸‹ç›‘æ§çš„æ•ˆæœã€‚

### é›†ç¾¤ç¯å¢ƒéƒ¨ç½²éªŒè¯
- éƒ¨ç½²server
serverè®°å¾—å¼€æ”¾å¥½ç«¯å£ï¼ŒåŒæ—¶æ³¨æ„ç½‘ç»œæœåŠ¡åç§°åƒä¸‡ä¸è¦è®¾ç½®ä¸ºarthas-serverï¼Œå› ä¸ºè¿™æ ·å¯åŠ¨åï¼Œç»™serveré…ç½®çš„ç³»ç»Ÿç¯å¢ƒå˜é‡ç«¯å£ä¼šå’Œåº”ç”¨é‡Œçš„arthas.server.port å†²çªã€‚
![image.png](https://s2.loli.net/2024/07/20/JnBemolKAX8EfzQ.png)
éƒ¨ç½²å¥½åï¼Œé…ç½®ç½‘ç®¡è·¯ç”±åå°±èƒ½åœ¨å…¬ç½‘æŸ¥çœ‹äº†ã€‚
![image.png](https://s2.loli.net/2024/07/20/yF5TPlM8URB67XS.png)
![image.png](https://s2.loli.net/2024/07/20/u35anbxTh9DEmS2.png)

- éƒ¨ç½²ç›®æ ‡æœåŠ¡
![image.png](https://s2.loli.net/2024/07/20/zEWAxPNrVktwmvb.png)

å®Œæˆä»¥ä¸Šæ“ä½œåï¼Œä½ çš„é›†ç¾¤æœ‰äº†ä¸€ä¸ªç”¨äºç›‘æ§çš„podï¼Œarthas serverï¼Œç„¶ååç»­éœ€è¦ç›‘æ§çš„ç›®æ ‡æœåŠ¡åŠ ä¸Šstarterä¾èµ–å°±å¯ä»¥é€šè¿‡arthas serverè¿›è¡Œè®¿é—®ï¼Œä½†æ˜¯æ³¨æ„ç›®å‰è¿˜å¹¶æ²¡ç”¨å®Œæˆå®Œæ•´å®ç°ç›‘æ§æ–¹æ¡ˆã€‚
è™½ç„¶èƒ½åœ¨serverçš„web consoleï¼Œæˆ–serverå¯¹å¤–çš„url/actuator/arthasä¸­çœ‹åˆ°å…·ä½“çš„è¿æ¥ä¿¡æ¯ï¼Œä½†æ˜¯ä½ ä½¿ç”¨æ§åˆ¶å°ä¼šå‘ç°ä»ç„¶æ— æ³•è®¿é—®ï¼Œè¿™æ˜¯å› ä¸ºæµè§ˆå™¨è®¿é—®æ—¶ï¼Œå½“å‰æµè§ˆå™¨ä¸ç›®æ ‡æœåŠ¡çš„ agentçš„ç½‘ç»œä¸é€šè€Œæ— æ³•è®¿é—®arthas agentçš„é—®é¢˜ï¼Œå› ä¸ºçº¿ä¸Šçš„ç½‘ç»œå’Œk8sä¸­serverã€agenté…ç½®çš„å‚æ•°éƒ½æ˜¯k8sé›†ç¾¤çš„ç½‘ç»œç­–ç•¥ï¼›
ç›®å‰æ¯”è¾ƒæœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆå°±æ˜¯é€šè¿‡ç»™tunnel serveræœåŠ¡å»ºç«‹websocketä»£ç†ï¼Œæµè§ˆå™¨çš„websocketè¯·æ±‚åœ¨serveræœåŠ¡ä¸­è½¬å‘ï¼Œæ–¹æ¡ˆæˆ‘å‚è€ƒè¿™ä½å¤§ä½¬å®ç°çš„ï¼š[Arthas Tunnel ServeråŠŸèƒ½æ‰©å±• - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7003001038181498910)
åç»­çš„å®è·µæµç¨‹æˆ‘æ”¾åˆ°äº†k8sé›†æˆArthasä¾èµ–å®ç°é›†ç¾¤å¤špodç›‘æ§ï¼ˆäºŒï¼‰ä¸­ï¼Œè®°å½•ä¸æ˜“ï¼Œå¦‚æœæœ‰å¸®åˆ°ä½ ï¼Œè¯·ç»™æˆ‘ç‚¹ä¸ªèµğŸ™